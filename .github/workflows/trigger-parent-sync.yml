# When main is updated (by Lovable, you, or an agent), tell Open-Agency-Artel to sync the submodule.
# Requires secret OPEN_AGENCY_ARTEL_DISPATCH_TOKEN in this repo (Agent-Artel-studio) with repo scope on Open-Agency-Artel.
name: Trigger Open-Agency-Artel submodule sync

on:
  push:
    branches: [main]

jobs:
  trigger:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger sync in Open-Agency-Artel
        run: |
          curl -sS -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.OPEN_AGENCY_ARTEL_DISPATCH_TOKEN }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/AgentArtel/Open-Agency-Artel/dispatches \
            -d '{"event_type":"sync-lovable"}'
